(window.webpackJsonp=window.webpackJsonp||[]).push([[322],{449:function(e,n,t){"use strict";t.r(n),t.d(n,"frontMatter",(function(){return a})),t.d(n,"rightToc",(function(){return i})),t.d(n,"metadata",(function(){return o})),t.d(n,"default",(function(){return u}));var r=t(1),l=t(9),s=(t(0),t(520)),a={id:"teach",uuid:"4adb1dc4-115c-4b2d-8dcf-2fc22f086e19",title:"\u63d2\u4ef6\u4f7f\u7528\u6848\u4f8b\u6559\u7a0b"},i=[{value:"\u5f15\u8a00",id:"\u5f15\u8a00",children:[{value:"todos",id:"todos",children:[]}]},{value:"\u9879\u76ee\u521d\u59cb\u5316",id:"\u9879\u76ee\u521d\u59cb\u5316",children:[]},{value:"\u4f7f\u7528UglifyPlugin\u538b\u7f29\u4ee3\u7801",id:"\u4f7f\u7528uglifyplugin\u538b\u7f29\u4ee3\u7801",children:[]},{value:"\u4f7f\u7528ResSplitPlugin\u5206\u79bb\u8d44\u6e90\u6587\u4ef6",id:"\u4f7f\u7528ressplitplugin\u5206\u79bb\u8d44\u6e90\u6587\u4ef6",children:[]},{value:"\u4f7f\u7528ZipPlugin\u628a\u6587\u4ef6\u538b\u7f29\u6210zip\u683c\u5f0f",id:"\u4f7f\u7528zipplugin\u628a\u6587\u4ef6\u538b\u7f29\u6210zip\u683c\u5f0f",children:[]},{value:"\u4f7f\u7528TextureMergerPlugin\uff0cConvertResConfigFilePlugin\u5408\u5e76\u7eb9\u7406\u96c6",id:"\u4f7f\u7528texturemergerplugin\uff0cconvertresconfigfileplugin\u5408\u5e76\u7eb9\u7406\u96c6",children:[]},{value:"\u7ed3\u8bed",id:"\u7ed3\u8bed",children:[]}],o={id:"cmdExtensionPlugin/teach",title:"\u63d2\u4ef6\u4f7f\u7528\u6848\u4f8b\u6559\u7a0b",description:"# \u63d2\u4ef6\u4f7f\u7528\u6848\u4f8b\u6559\u7a0b",source:"@site/docs/cmdExtensionPlugin/teach.md",permalink:"/engine/docs/cmdExtensionPlugin/teach",sidebar:"someSidebar",previous:{title:"API \u6587\u6863",permalink:"/engine/docs/cmdExtensionPlugin/api"},next:{title:"\u5728\u767d\u9e6d\u5f15\u64ce\u4e2d\u8c03\u7528\u7b2c\u4e09\u65b9 JavaScript \u4ee3\u7801",permalink:"/engine/docs/call-javascript/introduction"}},c={rightToc:i,metadata:o},p="wrapper";function u(e){var n=e.components,t=Object(l.a)(e,["components"]);return Object(s.b)(p,Object(r.a)({},c,t,{components:n,mdxType:"MDXLayout"}),Object(s.b)("h1",{id:"\u63d2\u4ef6\u4f7f\u7528\u6848\u4f8b\u6559\u7a0b"},"\u63d2\u4ef6\u4f7f\u7528\u6848\u4f8b\u6559\u7a0b"),Object(s.b)("h2",{id:"\u5f15\u8a00"},"\u5f15\u8a00"),Object(s.b)("p",null,"\u672c\u6587\u4e0d\u8be6\u7ec6\u4ecb\u7ecd\u5404\u63d2\u4ef6\u7684\u7ec6\u8282\uff0c\u53ea\u5c55\u793a\u4f7f\u7528\u65b9\u6cd5\uff0c\u5982\u679c\u5f00\u53d1\u8005\u5bf9\u7ec6\u8282\u6709\u5174\u8da3\u53ef\u4ee5\u53c2\u8003 ",Object(s.b)("a",Object(r.a)({parentName:"p"},{href:"/engine/docs/cmdExtensionPlugin/api"}),"API \u6587\u6863"),"\u3002"),Object(s.b)("p",null,"\u4e3a\u4e86\u8ba9\u5f00\u53d1\u8005\u4ee5\u66f4\u7b80\u5355\u7684\u4f7f\u7528Egret\u5185\u7f6e\u7684\u63d2\u4ef6\uff0c\u6211\u4eec\u5c06\u901a\u8fc7\u4e00\u4e2a\u6848\u4f8b\u6765\u5c55\u793a\u63d2\u4ef6\u7684\u5177\u4f53\u4f7f\u7528\u65b9\u6cd5\u548c\u6ce8\u610f\u4e8b\u9879\u3002",Object(s.b)("strong",{parentName:"p"},"\u672c\u6587\u57fa\u4e8e\u5f15\u64ce5.2.7\uff0c\u4f4e\u4e8e\u8be5\u7248\u672c\u7684\u5f15\u64ce\u53ef\u80fd\u90e8\u5206\u529f\u80fd\u65e0\u6548")),Object(s.b)("p",null,"\u672c\u6587\u6848\u4f8b\u4ece\u4e00\u4e2a\u521a\u7f16\u5199\u5b8c\u6210\u7684",Object(s.b)("a",Object(r.a)({parentName:"p"},{href:"http://bbs.egret.com/thread-50009-1-1.html"}),"eui\u5361\u724c\u9879\u76ee"),"\u5f00\u59cb\u53d1\u5e03\u5230\u5fae\u4fe1\u5c0f\u6e38\u620f\uff0c\u4e3a\u4e86\u8ba9\u4ee3\u7801\u5305\u7684",Object(s.b)("strong",{parentName:"p"},"\u4f53\u79ef\u66f4\u5c0f"),"\uff0c",Object(s.b)("strong",{parentName:"p"},"\u66f4\u597d\u7ba1\u7406"),"\uff0c\u9010\u6b65\u6dfb\u52a0\u4f7f\u7528\u4e0d\u540c\u7684\u63d2\u4ef6\uff0c\u4ee5\u5b9e\u73b0\u4e0d\u540c\u7684\u9700\u6c42\u3002",Object(s.b)("a",Object(r.a)({parentName:"p"},{href:"https://tool.egret-labs.org/DocZip/engine/plugin-egret-eui-demo2.zip"}),"\u6e90\u6587\u4ef6\u4e0b\u8f7d\u5730\u5740")),Object(s.b)("h3",{id:"todos"},"todos"),Object(s.b)("ul",null,Object(s.b)("li",{parentName:"ul"},"\u4f7f\u7528UglifyPlugin\u5c06\u4ee3\u7801\u6df7\u6dc6\u538b\u7f29"),Object(s.b)("li",{parentName:"ul"},"\u4f7f\u7528ResSplitPlugin\u628a\u90e8\u5206\u8d44\u6e90\u5206\u79bb\u51fa\u53bb"),Object(s.b)("li",{parentName:"ul"},"\u4f7f\u7528ZipPlugin\u628a\u6587\u4ef6\u538b\u7f29\u6210zip\u683c\u5f0f"),Object(s.b)("li",{parentName:"ul"},"\u4f7f\u7528TextureMergerPlugin\u5c06\u7eb9\u7406\u5408\u5e76\uff0c\u4e14\u7528ConvertResConfigFilePlugin\u4fee\u6539res.json\u914d\u7f6e\u6587\u4ef6")),Object(s.b)("h2",{id:"\u9879\u76ee\u521d\u59cb\u5316"},"\u9879\u76ee\u521d\u59cb\u5316"),Object(s.b)("ol",null,Object(s.b)("li",{parentName:"ol"},"\u628aindex.html\u4e2d\u7684",Object(s.b)("inlineCode",{parentName:"li"},"data-scale-mode"),"\u6539\u6210",Object(s.b)("inlineCode",{parentName:"li"},"fixedWidth")),Object(s.b)("li",{parentName:"ol"},"\u6253\u5f00EgretLauncher\uff0c\u5c06\u672c\u9879\u76ee\u53d1\u5e03\u6210\u5fae\u4fe1\u5c0f\u6e38\u620f"),Object(s.b)("li",{parentName:"ol"},"\u6253\u5f00\u5fae\u4fe1\u5f00\u53d1\u8005\u5de5\u5177")),Object(s.b)("h2",{id:"\u4f7f\u7528uglifyplugin\u538b\u7f29\u4ee3\u7801"},"\u4f7f\u7528UglifyPlugin\u538b\u7f29\u4ee3\u7801"),Object(s.b)("p",null,"\u5728\u5fae\u4fe1\u5f00\u53d1\u8005\u5de5\u5177\u53ef\u4ee5\u770b\u5230\uff0cjs\u6587\u4ef6\u5939\u4e2d5\u4e2a\u5e93\u6587\u4ef6\u548c\u4e00\u4e2a",Object(s.b)("inlineCode",{parentName:"p"},"main.js"),"\u3002"),Object(s.b)("p",null,"\u73b0\u5728\u9700\u6c42\u662f\u662f\u8981\u628a\u5e93\u6587\u4ef6\u538b\u7f29\u5230\u4e00\u4e2a\u6587\u4ef6",Object(s.b)("inlineCode",{parentName:"p"},"lib.min.js"),"\u4e2d\u3002"),Object(s.b)("p",null,"\u56de\u5230EgretWing\uff0c\u7f16\u8f91sctipts\u4e0b\u7684config.wxgame.ts\uff1a"),Object(s.b)("pre",null,Object(s.b)("code",Object(r.a)({parentName:"pre"},{className:"language-typescript"}),'//***\u5176\u4ed6\u4ee3\u7801***\n//\nif (command == "build") {\n    return {\n        outputDir,\n        commands: [\n            // \u6e05\u7406js\uff0cresource\u6587\u4ef6\u5939\n            new CleanPlugin({ matchers: ["js", "resource"] }),\n            new CompilePlugin({ libraryType: "debug", defines: { DEBUG: true, RELEASE: false } }),\n            new ExmlPlugin("commonjs"),\n            new WxgamePlugin(),\n            //  \u538b\u7f29\u63d2\u4ef6\n            new UglifyPlugin([\n                {\n                    // \u9700\u8981\u88ab\u538b\u7f29\u7684\u6587\u4ef6\n                    sources: [\n                        "libs/modules/egret/egret.js",\n                        "libs/modules/eui/eui.js",\n                        "libs/modules/assetsmanager/assetsmanager.js",\n                        "libs/modules/tween/tween.js",\n                    ],\n                    // \u538b\u7f29\u540e\u7684\u6587\u4ef6\n                    target: "lib.min.js"\n                }\n            ]),\n            new ManifestPlugin({ output: "manifest.js" })\n        ]\n    };\n}\n//\n// ***\u5176\u4ed6\u4ee3\u7801***\n\n')),Object(s.b)("p",null,"\u4fdd\u5b58\u540e\u5728\u7ec8\u7aef\u6267\u884c\uff1a"),Object(s.b)("pre",null,Object(s.b)("code",Object(r.a)({parentName:"pre"},{className:"language-shell"}),"egret build\n")),Object(s.b)("p",null,"static/js/egret.vivogame.js%E3%80%82"),Object(s.b)("p",null,"\u4f46\u662f\u62a5\u9519\uff0c\u627e\u4e0d\u5230eui\uff0c\u8fd9\u662f\u56e0\u4e3a\u81ea\u52a8\u751f\u6210\u7684",Object(s.b)("inlineCode",{parentName:"p"},"manifest.js"),"\u91cc\u9762\u5bf9js\u7684\u5f15\u7528\u987a\u5e8f\u51fa\u9519\uff0c\u9700\u8981\u4f18\u5148\u5f15\u7528lib.min.js"),Object(s.b)("p",null,"\u6253\u5f00\u6839\u76ee\u5f55\u4e0b\u7684",Object(s.b)("inlineCode",{parentName:"p"},"manifest.js"),"\uff0c \u4fee\u6539\u4e00\u4e0b\u5f15\u7528\u987a\u5e8f\u3002"),Object(s.b)("pre",null,Object(s.b)("code",Object(r.a)({parentName:"pre"},{className:"language-typescript"}),'require("js/lib.min.js");\nrequire("js/main.js");\nrequire("js/default.thm.js");\n\n')),Object(s.b)("p",null,"\u6bcf\u6b21\u7f16\u8bd1\u7684\u65f6\u5019",Object(s.b)("inlineCode",{parentName:"p"},"manifest.js"),"\u90fd\u4f1a\u88ab\u91cd\u65b0\u751f\u6210\uff0c\u6240\u4ee5\u6211\u4eec\u4f7f\u7528\u4e00\u4e2a\u81ea\u5b9a\u4e49\u811a\u672c\u6765\u4fee\u6539\u4ed6\u4eec\u7684\u987a\u5e8f"),Object(s.b)("p",null,"\u6253\u5f00 scripts\u4e0b\u7684myPlugin.ts :"),Object(s.b)("pre",null,Object(s.b)("code",Object(r.a)({parentName:"pre"},{className:"language-typescript"}),'/**\n * \u793a\u4f8b\uff0c\u4e86\u89e3\u5982\u4f55\u5f00\u53d1\u4e00\u4e2a\u81ea\u5b9a\u4e49\u63d2\u4ef6\n */\nexport class CustomPlugin implements plugins.Command {\n    private buffer;\n    constructor() {\n    }\n    async onFile(file: plugins.File) {\n        // \u4fdd\u5b58manifest.js\u6587\u4ef6\u7684\u5185\u5bb9\n        if (file.basename.indexOf("manifest.js") > -1) {\n            this.buffer = file.contents;\n        }\n        return file;\n    }\n    async onFinish(commandContext: plugins.CommandContext) {\n        // \u628a\'lib.min.js\'\u79fb\u5230\u7b2c\u4e00\u4f4d\n        if (this.buffer) {\n            let contents: string = this.buffer.toString();\n            let arr = contents.split("\\n");\n            let lib;\n            arr.forEach((item, index) => {\n                if (item.indexOf("lib.min.js") > -1) {\n                    lib = item;\n                    arr.splice(index, 1);\n                }\n            });\n            if (lib != null) {\n                arr.unshift(lib);\n            }\n            let newCont = arr.join("\\n");\n            commandContext.createFile("manifest.js", new Buffer(newCont));\n        }\n    }\n}\n\n')),Object(s.b)("p",null,"\u8fd9\u4e2a\u6587\u4ef6\u5c31\u662f\u7528\u6765\u81ea\u5b9a\u4e49\u63d2\u4ef6\u7684\uff0c\u5728config.wxgame.ts\u4e2d\u5df2\u7ecf\u9ed8\u8ba4\u5f15\u7528\uff0c\u6240\u4ee5\u53ea\u9700\u8981\u8c03\u7528\u5373\u53ef\uff0c\u6ce8\u610f\u8c03\u7528\u987a\u5e8f"),Object(s.b)("pre",null,Object(s.b)("code",Object(r.a)({parentName:"pre"},{className:"language-typescript"}),'new ManifestPlugin({ output: "manifest.js" }),\n    // \u5728manifest.js\u751f\u6210\u4e4b\u540e\u8c03\u7528\n    new CustomPlugin();\n\n')),Object(s.b)("h2",{id:"\u4f7f\u7528ressplitplugin\u5206\u79bb\u8d44\u6e90\u6587\u4ef6"},"\u4f7f\u7528ResSplitPlugin\u5206\u79bb\u8d44\u6e90\u6587\u4ef6"),Object(s.b)("p",null,"\u56e0\u4e3a\u5fae\u4fe1\u5bf9\u4ee3\u7801\u5305\u7684\u5927\u5c0f\u662f\u6709\u9650\u5236\u7684\uff0c\u603b\u5927\u5c0f\u4e0d\u80fd\u8d85\u8fc74M\uff08\u4f7f\u7528\u5206\u5305\u529f\u80fd\u53ef\u4ee5\u63d0\u5347\u52308M\uff09\uff0c\u6240\u4ee5\u6211\u4eec\u9700\u8981\u901a\u8fc7ResSplitPlugin\u628a\u67d0\u4e9b\u6e38\u620f\u8d44\u6e90\u6587\u4ef6\u5206\u79bb\u51fa\u53bb\uff0c\u5c06\u6e38\u620f\u8d44\u6e90\u653e\u7f6e\u5728\u4e00\u4e2a\u5916\u90e8CDN\u670d\u52a1\u5668\u4e0a\uff0c\u9700\u8981\u7684\u65f6\u5019\u52a8\u6001\u52a0\u8f7d\u5373\u53ef\u3002"),Object(s.b)("p",null,"\u7f16\u8f91config.wxgame.ts\uff1a"),Object(s.b)("pre",null,Object(s.b)("code",Object(r.a)({parentName:"pre"},{className:"language-typescript"}),'// ***\u5176\u4ed6\u4ee3\u7801***\n//\nnew ResSplitPlugin({\n    verbose: false, matchers: [\n        // from \u4f7f\u7528glob\u8868\u8fbe\u5f0f\u6765\u5339\u914d\u6587\u4ef6\uff0c  projectName\u5c31\u662f\u9879\u76ee\u7684\u540d\u5b57\n        { from: "resource/art/about/**.**", to: `${projectName}_wxgame_remote` },\n        { from: "resource/art/heros_goods/**.**", to: `${projectName}_wxgame_remote` }\n    ]\n});\n// ***\u5176\u4ed6\u4ee3\u7801***\n\n')),Object(s.b)("p",null,"\u4fdd\u5b58\u540e\u5728\u7ec8\u7aef\u6267\u884c\uff1a"),Object(s.b)("pre",null,Object(s.b)("code",Object(r.a)({parentName:"pre"},{className:"language-shell"}),"egret build\n")),Object(s.b)("p",null,"\u5fae\u4fe1\u5f00\u53d1\u8005\u5de5\u5177\u4e2dresource > art \u4e0b\u7684",Object(s.b)("inlineCode",{parentName:"p"},"about"),"\u548c",Object(s.b)("inlineCode",{parentName:"p"},"heros_goods"),"\u5df2\u7ecf\u4e0d\u5728\u4e86\u3002"),Object(s.b)("p",null,"\u88ab\u5206\u79bb\u51fa\u53bb\u7684\u5728 Egret \u9879\u76ee\u6839\u76ee\u5f55\u4e2d ",Object(s.b)("inlineCode",{parentName:"p"},"egret-eui-demo_wxgame_remote")," \u6587\u4ef6\u5939\u5185\u3002"),Object(s.b)("ul",null,Object(s.b)("li",{parentName:"ul"},Object(s.b)("em",{parentName:"li"},"\u6ce8\u610f 1\uff1a")," \u9700\u8981\u5f00\u53d1\u8005\u81ea\u5df1\u5199\u903b\u8f91\uff0c\u5224\u65ad\u4e00\u4e0b\u5982\u679c\u662f\u5fae\u4fe1\u6e38\u620f\u65f6\uff0c\u54ea\u4e9b\u8d44\u6e90\u662f\u4ece\u8fdc\u7a0b\u52a0\u8f7d\u7684\uff0c\u54ea\u4e9b\u662f\u653e\u5728\u672c\u5730\u7684"),Object(s.b)("li",{parentName:"ul"},Object(s.b)("em",{parentName:"li"},"\u6ce8\u610f 2\uff1a")," \u4e3a\u4e86\u4fbf\u4e8e\u8c03\u8bd5\uff0c\u6211\u4eec\u628a\u8d44\u6e90\u653e\u5728\u4e86 Egret \u9879\u76ee\u6839\u76ee\u5f55\u4e2d ",Object(s.b)("inlineCode",{parentName:"li"},"egret-eui-demo_wxgame_remote")," \u6587\u4ef6\u5939\u5185\uff0c\u6b63\u5f0f\u53d1\u5e03\u7684\u4e00\u822c\u653e\u5728 CDN \u4e0a")),Object(s.b)("h2",{id:"\u4f7f\u7528zipplugin\u628a\u6587\u4ef6\u538b\u7f29\u6210zip\u683c\u5f0f"},"\u4f7f\u7528ZipPlugin\u628a\u6587\u4ef6\u538b\u7f29\u6210zip\u683c\u5f0f"),Object(s.b)("p",null,"\u4e3a\u4e86\u51cf\u5c11\u52a0\u8f7d\u6b21\u6570\u548c\u4f20\u8f93\u91cf\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u6587\u4ef6\u538b\u7f29\u6210zip\u683c\u5f0f\uff0c\u4f7f\u7528\u7684\u65f6\u5019\u53ef\u4ee5\u4f7f\u7528\u7b2c\u4e09\u65b9\u5e93JSZip\u6765\u8bfb\u53d6\u4f7f\u7528zip\u6587\u4ef6\u3002"),Object(s.b)("p",null,"\u4f7f\u7528ZipPlugin\u63d2\u4ef6\u4e4b\u524d\uff0c\u9700\u8981\u5b89\u88c5cross-zip \u548c cross-zip-cli \uff0c \u5728\u7ec8\u7aef\u4e2d\u8f93\u5165\uff1a"),Object(s.b)("pre",null,Object(s.b)("code",Object(r.a)({parentName:"pre"},{className:"language-shell"}),"//\u5168\u5c40\u5b89\u88c5\nnpm install cross-zip -g   \nnpm install cross-zip-cli -g\n")),Object(s.b)("p",null,"\u5b89\u88c5\u5b8c\u6210\u4e4b\u540e\uff0c\u5728config.wxgame.ts\u6dfb\u52a0\u4ee3\u7801\uff1a"),Object(s.b)("pre",null,Object(s.b)("code",Object(r.a)({parentName:"pre"},{className:"language-typescript"}),'new ZipPlugin({\n    mergeSelector: p => {\n        // \u5982\u679c\u6587\u4ef6\u662fassets/\u8def\u5f84\u4e0b\u7684\uff0c \u538b\u7f29\u5230assets.zip\n        if (p.indexOf("assets/") >= 0) {\n            return "assets.zip";\n        }\n    }\n});\n\n')),Object(s.b)("p",null,"\u9879\u76ee\u4e2d\u5176\u5b9eassets\u91cc\u9762\u7684\u8d44\u6e90\u90fd\u662f\u6ca1\u6709\u7528\u5230\u7684\uff0c\u8fd9\u91cc\u6211\u4eec\u7528\u5b83\u6765\u6f14\u793a\u538b\u7f29\u63d2\u4ef6\u7684\u4f7f\u7528\u3002"),Object(s.b)("p",null,"\u4fdd\u5b58\u540e\u5728\u7ec8\u7aef\u6267\u884c\uff1a"),Object(s.b)("pre",null,Object(s.b)("code",Object(r.a)({parentName:"pre"},{className:"language-shell"}),"egret build\n")),Object(s.b)("p",null,"\u6267\u884c\u4e4b\u540e\u53ef\u4ee5\u5728\u5fae\u4fe1\u5f00\u53d1\u8005\u5de5\u5177\u770b\u5230\uff0cresource\u76ee\u5f55\u4e0b\u539f\u6765\u7684assets\u6587\u4ef6\u5939\u5df2\u7ecf\u88ab\u538b\u7f29\u6210\u4e86assets.zip\u3002"),Object(s.b)("h2",{id:"\u4f7f\u7528texturemergerplugin\uff0cconvertresconfigfileplugin\u5408\u5e76\u7eb9\u7406\u96c6"},"\u4f7f\u7528TextureMergerPlugin\uff0cConvertResConfigFilePlugin\u5408\u5e76\u7eb9\u7406\u96c6"),Object(s.b)("p",null,"\u9879\u76ee\u4e2d\u4f7f\u7528\u7684\u56fe\u7247\u8d44\u6e90\u90fd\u662f\u5355\u72ec\u7684png\u6587\u4ef6\uff0c\u5728\u52a0\u8f7d\u7684\u65f6\u5019\u6bcf\u5f20\u56fe\u7247\u90fd\u4f1a\u5355\u72ec\u8bf7\u6c42\u3002\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u5408\u5e76\u7eb9\u7406\u96c6\u7684\u65b9\u5f0f\u628a\u8fd9\u4e9b\u56fe\u7247\u5408\u6210\u4e00\u5f20\u56fe\uff0c\u4ee5\u51cf\u5c11\u8bf7\u6c42\u6570\u91cf\u3002\n\u4f7f\u7528\u63d2\u4ef6\u4e4b\u524d\uff0c\u6211\u4eec\u9700\u8981\u6709\u7eb9\u7406\u96c6\u7684\u914d\u7f6e\u6587\u4ef6",Object(s.b)("inlineCode",{parentName:"p"},"tmpropject"),"\uff0c \u53ef\u4ee5\u7528\u4e24\u79cd\u65b9\u5f0f\u751f\u6210\uff1a"),Object(s.b)("ol",null,Object(s.b)("li",{parentName:"ol"},"\u5b89\u88c5",Object(s.b)("a",Object(r.a)({parentName:"li"},{href:"https://egret.com/downloads/texture.html"}),"TextureMerger\u5de5\u5177")),Object(s.b)("li",{parentName:"ol"},"\u6267\u884c\u811a\u672c\u751f\u6210")),Object(s.b)("p",null,"static/js/egret.vivogame.js%EF%BC%9A"),Object(s.b)("pre",null,Object(s.b)("code",Object(r.a)({parentName:"pre"},{className:"language-typescript"}),'"use strict";\nObject.defineProperty(exports, "__esModule", { value: true });\nconst fs = require("fs");\nconst path = require("path");\nconst resjsons = ["resource/default.res.json"]; //\u8981\u626b\u63cf\u7684res.json\u6587\u4ef6\nconst targetDir = "resource/TextureMerger"; //\u8f93\u51fa\u76ee\u5f55\nconst pathNor = path.relative(targetDir, "resource"); //\u8fd4\u56de\u4e00\u4e2a\u76f8\u5bf9\u8def\u5f84\nconst tempindex = 0;\n//\u521b\u5efa\u8f93\u51fa\u6587\u4ef6\u5939\nif (resjsons.length > 0) {\n    if (!fs.existsSync(targetDir)) {\n        // var paths = path.normalize(targetDir).split("\\\\");   //windows \u4e0b\u4f7f\u7528\n        const paths = path.normalize(targetDir).split("/"); //mac linux \u4e0b\u4f7f\u7528\n        let target = ".";\n        for (let _i = 0, paths_1 = paths; _i < paths_1.length; _i++) {\n            const p = paths_1[_i];\n            // target += ("\\\\" + p);  // windows \u4e0b\u4f7f\u7528\n            target += ("/" + p); // mac linux \u4e0b\u4f7f\u7528\n            if (!fs.existsSync(target))\n                // \u6839\u636e\u8def\u5f84\u521b\u5efa\u6587\u4ef6\u5939\n                fs.mkdirSync(target);\n        }\n    }\n}\nconst _loop_1 = function (resJson) {\n    // \u5224\u65ad\u662f\u5426\u662fres.json\u6587\u4ef6\n    if (fs.existsSync(resJson) && resJson.indexOf("res.json") > -1) {\n        const defaultJson = fs.readFileSync(resJson, "utf-8");\n        // \u89e3\u6790res.json\u6587\u4ef6\u5185\u5bb9\n        const defaultObject = JSON.parse(defaultJson);\n        const groups = defaultObject.groups; //\u7ec4\n        const resources = defaultObject.resources; //\u8d44\u6e90\n        const resourcesHash_1 = {}; // \u7528\u6765\u5b58\u653eresources\u7684\u8d44\u6e90\u4fe1\u606f\n        // \u904d\u5386resources\n        for (let _i = 0, resources_1 = resources; _i < resources_1.length; _i++) {\n            const resource = resources_1[_i];\n            resourcesHash_1[resource.name] = resource.url;\n        }\n        // \u904d\u5386groups\n        for (let _a = 0, groups_1 = groups; _a < groups_1.length; _a++) {\n            const group = groups_1[_a];\n            let tmproject = {}; //\u7528\u6765\u5b58\u653etmproject\u6587\u4ef6\u7684\u4fe1\u606f\n            // tmproject\u6587\u4ef6\u914d\u7f6e\n            tmproject["options"] = {\n                "layoutMath": "2",\n                "sizeMode": "2n",\n                "useExtension": 1,\n                "layoutGap": 1,\n                "extend": 0\n            };\n            // projectName\n            tmproject["projectName"] = group.name + "_" + tempindex;\n            // \u7248\u672c\n            tmproject["version"] = 5;\n            tempindex++;\n            // \u83b7\u53d6res.json\u5206\u7ec4\u7684keys, \u5e76\u5206\u5272\u6210\u6570\u7ec4\n            let oldkeys = group.keys.split(",");\n            let oldkeysHash = {};\n            // \u904d\u5386oldkeys\n            for (let _b = 0, oldkeys_1 = oldkeys; _b < oldkeys_1.length; _b++) {\n                const key = oldkeys_1[_b];\n                // \u4fdd\u5b58\u5230oldkeysHash\u5bf9\u8c61\u4e2d\n                oldkeysHash[key] = true;\n            }\n            const newKeys = [];\n            // \u904d\u5386oldkeys\n            for (let _c = 0, oldkeys_2 = oldkeys; _c < oldkeys_2.length; _c++) {\n                const key = oldkeys_2[_c];\n                if (key.indexOf("json") == -1) {\n                    if (!oldkeysHash[key.replace("png", "json")]) { //\u7c92\u5b50\u548c\u9f99\u9aa8\u5bf9\u5e94\u7684\u56fe\u96c6\u4e0d\u5408\u56fe\n                        if (!oldkeysHash[key.replace("png", "fnt")]) //\u4f4d\u56fe\u5b57\u4f53\n                            newKeys.push(key);\n                    }\n                    else if (key.indexOf("jpg") > -1) {\n                        newKeys.push(key);\n                    }\n                }\n            }\n            oldkeysHash = {};\n            oldkeys = [];\n            // files\u8def\u5f84\n            const urls = newKeys.map(function (key) {\n                return path.join(pathNor, resourcesHash_1[key]);\n            });\n            tmproject["files"] = urls;\n            // \u6839\u636etmproject\u5199\u5165\u6587\u4ef6\n            if (urls.length > 0) {\n                fs.writeFileSync(path.join(targetDir, tmproject["projectName"] + ".tmproject"), JSON.stringify(tmproject));\n            }\n            tmproject = {};\n        }\n    }\n};\n//\u6839\u636e\u6570\u7ec4\u5f00\u59cb\u626b\u63cf\nfor (let _a = 0, resjsons_1 = resjsons; _a < resjsons_1.length; _a++) {\n    const resJson = resjsons_1[_a];\n    _loop_1(resJson);\n}\n\n')),Object(s.b)("p",null,"\u628a\u8fd9\u4e2a\u811a\u672c\u653e\u5728scripts\u6587\u4ef6\u5939\u5185\uff0c\u8fd9\u4e2a\u811a\u672c\u662f\u6839\u636e\u9879\u76ee\u7684",Object(s.b)("inlineCode",{parentName:"p"},"default.res.json"),"\u6587\u4ef6\u7684\u5185\u5bb9\u6765\u751f\u6210",Object(s.b)("inlineCode",{parentName:"p"},"tmpropject"),"\u6587\u4ef6"),Object(s.b)("p",null,"\u5728\u7ec8\u7aef\u4e2d\u6267\u884c\uff1a"),Object(s.b)("pre",null,Object(s.b)("code",Object(r.a)({parentName:"pre"},{className:"language-shell"}),"static/js/egret.vivogame.js")),Object(s.b)("p",null,"\u6267\u884c\u6210\u529f\u4e4b\u540e\u53ef\u4ee5\u5728resource\u6587\u4ef6\u5939\u4e2d\u770b\u5230\u591a\u51fa\u4e86\u4e00\u4e2aTextureMerger\u6587\u4ef6\u5939\uff0c\u91cc\u9762\u5c31\u662f\u6839\u636e",Object(s.b)("inlineCode",{parentName:"p"},"default.res.json"),"\u5206\u7ec4\u751f\u6210\u7684",Object(s.b)("inlineCode",{parentName:"p"},"tmpropject"),"\u6587\u4ef6\u3002"),Object(s.b)("p",null,"\u73b0\u5728\u53ea\u9700\u8981\u6267\u884cTextureMergerPlugin\u63d2\u4ef6\u5c31\u53ef\u4ee5\u81ea\u52a8\u5408\u5e76\uff0c\u8fd9\u91cc\u9700\u8981\u6ce8\u610fTextureMergerPlugin\u4f9d\u8d56 TextureMerger 1.7 \u4ee5\u4e0a\u7684\u7248\u672c\uff0c\u5982\u679c\u4e0d\u7b26\u5408\u8bf7\u81ea\u884c\u5b89\u88c5\uff0c\u5e76\u4e14\u5728\u8fd0\u884c\u65f6TextureMerger\u9700\u8981\u5904\u4e8e\u5173\u95ed\u72b6\u6001\u3002"),Object(s.b)("pre",null,Object(s.b)("code",Object(r.a)({parentName:"pre"},{className:"language-typescript"}),'new TextureMergerPlugin({ textureMergerRoot: ["resource"] });\n\n')),Object(s.b)("p",null,"\u4fdd\u5b58\u540e\u5728\u7ec8\u7aef\u6267\u884c\uff1a"),Object(s.b)("pre",null,Object(s.b)("code",Object(r.a)({parentName:"pre"},{className:"language-shell"}),"egret build\n")),Object(s.b)("p",null,"\u6267\u884c\u5b8c\u6210\u540e\uff0c\u5728\u5fae\u4fe1\u5f00\u53d1\u8005\u5de5\u5177\u53ef\u4ee5\u770b\u5230\uff0cresource > TextureMerger \u5185\u65b0\u589e\u4e86\u4e09\u4e2apng\u6587\u4ef6\uff0c\u5c31\u662f\u5408\u5e76\u4e4b\u540e\u7684\u7eb9\u7406\u96c6\u3002\u6e38\u620f\u8fd0\u884c\u7684\u65f6\u5019\u53ea\u9700\u8981\u52a0\u8f7d\u8fd9\u4e09\u4e2a\u7eb9\u7406\u96c6\u5c31\u53ef\u4ee5\uff0c\u65e0\u9700\u52a0\u8f7d\u90a3\u4e9b\u5355\u72ec\u7684png\u6587\u4ef6\u4f46\u662f\u9700\u8981\u53bbres.json\u91cc\u9762\u914d\u7f6e\uff0c\u628a\u5355\u72ec\u7684\u8d44\u6e90\u5f15\u7528\u90fd\u5220\u9664\uff0c\u52a0\u4e0a\u7eb9\u7406\u96c6\u7684\u5f15\u7528\u3002"),Object(s.b)("p",null,"\u8fd9\u4e9b\u64cd\u4f5c\u5f53\u7136\u4e0d\u9700\u8981\u624b\u52a8\u53bb\u5b8c\u6210\uff0c\u73b0\u5728\u53ea\u9700\u8981\u4f7f\u7528ConvertResConfigFilePlugin\u63d2\u4ef6\u5c31\u53ef\u4ee5\u5b9e\u73b0\u8fd9\u4e2a\u529f\u80fd\u3002"),Object(s.b)("p",null,"\u7f16\u8f91config.wxgame.ts\uff1a"),Object(s.b)("pre",null,Object(s.b)("code",Object(r.a)({parentName:"pre"},{className:"language-typescript"}),'new TextureMergerPlugin({ textureMergerRoot: ["resource"] });\nnew ConvertResConfigFilePlugin({\n    resourceConfigFiles: [{ filename: "resource/default.res.json", root: "resource/" }],\n    nameSelector: (p) => {\n        return path.basename(p).split(".").join("_");\n    },\n    TM_Verbose: true\n});\n\n')),Object(s.b)("p",null,"\u4fdd\u5b58\u540e\u5728\u7ec8\u7aef\u6267\u884c\uff1a"),Object(s.b)("pre",null,Object(s.b)("code",Object(r.a)({parentName:"pre"},{className:"language-shell"}),"egret build\n")),Object(s.b)("p",null,"\u5728\u5fae\u4fe1\u5f00\u53d1\u8005\u5de5\u5177\u4e2d\uff0c\u6253\u5f00\u8c03\u8bd5\u5668\uff0c\u5728network\u9762\u677f\u53ef\u4ee5\u770b\u5230\u52a0\u8f7d\u7684\u7eb9\u7406\u96c6\u3002"),Object(s.b)("p",null,"\u8fd9\u91cc\u6709\u4e2a\u6ce8\u610f\u4e8b\u9879\uff0c\u5728\u6e38\u620f\u4e2d\u70b9\u51fb\u82f1\u96c4\u6309\u94ae\uff0c\u5207\u6362\u5230\u82f1\u96c4\u573a\u666f\u65f6\uff0c\u4f1a\u53d1\u73b0\u5217\u8868\u91cc\u9762\u7684\u56fe\u7247\u52a0\u8f7d\u4e0d\u51fa\u6765\u3002"),Object(s.b)("p",null,"\u5728network\u9762\u677f\u53ef\u4ee5\u770b\u5230\u52a0\u8f7d\u8bf7\u6c42\u662f\u5355\u72ec\u7684png\u6587\u4ef6\uff0c\u800c\u4e0d\u662f\u7eb9\u7406\u96c6\u3002"),Object(s.b)("p",null,"\u8fd9\u662f\u56e0\u4e3a\u5217\u8868\u4e2d\u7684\u56fe\u7247\u5730\u5740\u662f\u76f4\u63a5\u4f7f\u7528url\u3002"),Object(s.b)("pre",null,Object(s.b)("code",Object(r.a)({parentName:"pre"},{className:"language-typescript"}),'// \u539f\u59cb\u6570\u7ec4\nlet dataArr: any[] = [\n    { image: "resource/art/heros_goods/heros01.png", name: "\u4e9a\u7279\u4f0d\u5fb7", value: "\u8bc4\u4ef7: \u5f88\u7279\u4e48\u5389\u5bb3, \u4e3a\u6240\u6b32\u4e3a", isSelected: false },\n    { image: "resource/art/heros_goods/heros02.png", name: "\u4e9a\u7279\u4f0d\u5fb7", value: "\u8bc4\u4ef7: \u5f88\u7279\u4e48\u5389\u5bb3, \u4e3a\u6240\u6b32\u4e3a", isSelected: false },\n    { image: "resource/art/heros_goods/heros03.png", name: "\u4e9a\u7279\u4f0d\u5fb7", value: "\u8bc4\u4ef7: \u5f88\u7279\u4e48\u5389\u5bb3, \u4e3a\u6240\u6b32\u4e3a", isSelected: true },\n    { image: "resource/art/heros_goods/heros04.png", name: "\u4e9a\u7279\u4f0d\u5fb7", value: "\u8bc4\u4ef7: \u5f88\u7279\u4e48\u5389\u5bb3, \u4e3a\u6240\u6b32\u4e3a", isSelected: false },\n    { image: "resource/art/heros_goods/heros05.png", name: "\u4e9a\u7279\u4f0d\u5fb7", value: "\u8bc4\u4ef7: \u5f88\u7279\u4e48\u5389\u5bb3, \u4e3a\u6240\u6b32\u4e3a", isSelected: false },\n    { image: "resource/art/heros_goods/heros06.png", name: "\u4e9a\u7279\u4f0d\u5fb7", value: "\u8bc4\u4ef7: \u5f88\u7279\u4e48\u5389\u5bb3, \u4e3a\u6240\u6b32\u4e3a", isSelected: false },\n    { image: "resource/art/heros_goods/heros07.png", name: "\u4e9a\u7279\u4f0d\u5fb7", value: "\u8bc4\u4ef7: \u5f88\u7279\u4e48\u5389\u5bb3, \u4e3a\u6240\u6b32\u4e3a", isSelected: false }\n];\n// \u8f6c\u6210eui\u6570\u636e\nlet euiArr: eui.ArrayCollection = new eui.ArrayCollection(dataArr);\n// \u628alist_hero\u6570\u636e\u6e90\u8bbe\u7f6e\u6210euiArr\nthis.list_hero.dataProvider = euiArr;\n// \u8bbe\u7f6elist_hero\u7684\u9879\u5448\u89c6\u5668 (\u8fd9\u91cc\u76f4\u63a5\u5199\u7c7b\u540d,\u800c\u4e0d\u662f\u5199\u5b9e\u4f8b)\nthis.list_hero.itemRenderer = heroList_item;\n\n')),Object(s.b)("p",null,"\u8fd9\u79cd\u5f15\u7528\u65b9\u5f0f\u7684\u56fe\u7247\uff0c\u9700\u8981\u5f00\u53d1\u8005\u624b\u52a8\u5728\u4ee3\u7801\u4e2d\u4fee\u6539\uff0c\u5c06\u56fe\u7247\u5730\u5740\u4fee\u6539\u6210\u7eb9\u7406\u96c6\u4e2d\u7684\u56fe\u7247\u3002"),Object(s.b)("h2",{id:"\u7ed3\u8bed"},"\u7ed3\u8bed"),Object(s.b)("p",null,"\u672c\u6587\u901a\u8fc7\u4f7f\u7528UglifyPlugin\uff0cResSplitPlugin\uff0cZipPlugin\uff0cTextureMergerPlugin\uff0cConvertResConfigFilePlugin\u63d2\u4ef6\uff0c\u4f7f\u9879\u76ee\u53d1\u5e03\u5230\u5fae\u4fe1\u5c0f\u7a0b\u5e8f\u4e4b\u540e\u7684\u4ee3\u7801\u5305\u4f53\u79ef\u51cf\u5c0f\uff0c\u7528\u6237\u53d1\u8d77\u7684\u8bf7\u6c42\u6570\u53d8\u5c11\uff0c\u4e14\u5c06\u4ee3\u7801\u6df7\u6dc6\u538b\u7f29\u3002"),Object(s.b)("p",null,"\u4f7f\u7528Egret\u81ea\u5e26\u7684\u63d2\u4ef6\uff0c\u5df2\u7ecf\u53ef\u4ee5\u6ee1\u8db3\u5f00\u53d1\u8005\u7684\u57fa\u672c\u9700\u6c42\uff0c\u5982\u679c\u6709\u9488\u5bf9\u9879\u76ee\u7684\u7279\u6b8a\u9700\u6c42\uff0c\u53ef\u4ee5\u9009\u62e9",Object(s.b)("a",Object(r.a)({parentName:"p"},{href:"/engine/docs/cmdExtensionPlugin/plugin"}),"\u81ea\u5b9a\u4e49\u63d2\u4ef6"),"\u3002"))}u.isMDXComponent=!0},520:function(e,n,t){"use strict";t.d(n,"a",(function(){return u})),t.d(n,"b",(function(){return m}));var r=t(0),l=t.n(r);function s(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){s(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function o(e,n){if(null==e)return{};var t,r,l=function(e,n){if(null==e)return{};var t,r,l={},s=Object.keys(e);for(r=0;r<s.length;r++)t=s[r],n.indexOf(t)>=0||(l[t]=e[t]);return l}(e,n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)t=s[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(l[t]=e[t])}return l}var c=l.a.createContext({}),p=function(e){var n=l.a.useContext(c),t=n;return e&&(t="function"==typeof e?e(n):i({},n,{},e)),t},u=function(e){var n=p(e.components);return l.a.createElement(c.Provider,{value:n},e.children)},b="mdxType",g={inlineCode:"code",wrapper:function(e){var n=e.children;return l.a.createElement(l.a.Fragment,{},n)}},j=Object(r.forwardRef)((function(e,n){var t=e.components,r=e.mdxType,s=e.originalType,a=e.parentName,c=o(e,["components","mdxType","originalType","parentName"]),u=p(t),b=r,j=u["".concat(a,".").concat(b)]||u[b]||g[b]||s;return t?l.a.createElement(j,i({ref:n},c,{components:t})):l.a.createElement(j,i({ref:n},c))}));function m(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var s=t.length,a=new Array(s);a[0]=j;var i={};for(var o in n)hasOwnProperty.call(n,o)&&(i[o]=n[o]);i.originalType=e,i[b]="string"==typeof e?e:r,a[1]=i;for(var c=2;c<s;c++)a[c]=t[c];return l.a.createElement.apply(null,a)}return l.a.createElement.apply(null,t)}j.displayName="MDXCreateElement"}}]);